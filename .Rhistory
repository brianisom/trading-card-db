sahf
library(data.table)
library(dplyr)
library(tidyr)
?fread
db <- fread("2022-Panini-Rookies-and-Stars-Football-Checklist.csv")
db <- fread("2022-Panini-Rookies-and-Stars-Football-Checklist.csv")
year <- db$year[2]
View(db)
year
set <- db$set[2]
year <- as.character(db$year[2])
variation <- as.list(db$variation)
name <- as.list(db$name)
View(db)
db$url <- paste0("https://www.ebay.com/sch/i.html?_from=R40&_trksid=p2334524.m570.l1313&_nkw=",
db$year,"+",
db$set,"+",
db$variation,"+",
db$name,"&_sacat=0&LH_TitleDesc=0&_osacat=0&_odkw=",
db$year,"+",
db$set,"+",
db$variation,"+",
db$name,"&LH_Complete=1&LH_Sold=1"
)
db$url <- sub(" ","+",paste0("https://www.ebay.com/sch/i.html?_from=R40&_trksid=p2334524.m570.l1313&_nkw=",
db$year,"+",
db$set,"+",
db$variation,"+",
db$name,"&_sacat=0&LH_TitleDesc=0&_osacat=0&_odkw=",
db$year,"+",
db$set,"+",
db$variation,"+",
db$name,"&LH_Complete=1&LH_Sold=1"
)
)
db$url <- paste0("https://www.ebay.com/sch/i.html?_from=R40&_trksid=p2334524.m570.l1313&_nkw=",
db$year,"+",
db$set,"+",
db$variation,"+",
db$name,"&_sacat=0&LH_TitleDesc=0&_osacat=0&_odkw=",
db$year,"+",
db$set,"+",
db$variation,"+",
db$name,"&LH_Complete=1&LH_Sold=1"
)
sub(" ","+",db$url)
db$url <- sub(" ","+",db$url)
db$url <- gsub(" ","+",db$url)
rm(db)
db <- fread("2022-Panini-Rookies-and-Stars-Football-Checklist.csv")
db$url <- gsub(" ","+",paste0(
"https://www.ebay.com/sch/i.html?_from=R40&_trksid=p2334524.m570.l1313&_nkw=",
db$year,"+",
db$set,"+",
db$variation,"+",
db$name,"&_sacat=0&LH_TitleDesc=0&_osacat=0&_odkw=",
db$year,"+",
db$set,"+",
db$variation,"+",
db$name,"&LH_Complete=1&LH_Sold=1"
)
)
rm(db)
db <- fread("2022-Panini-Rookies-and-Stars-Football-Checklist.csv")
db$url <- gsub(" ","+",paste0(
"https://www.ebay.com/sch/i.html?_from=R40&_trksid=p2334524.m570.l1313&_nkw=",
db$year,"+",
db$set,"+",
db$variation,"+",
db$name,"&_sacat=0&LH_TitleDesc=0&_osacat=0&_odkw=",
db$year,"+",
db$set,"+",
db$variation,"+",
db$name,"&LH_Complete=1&LH_Sold=1"
)
)
rm(db)
path <- "2022-Panini-Rookies-and-Stars-Football-Checklist.csv"
db <- fread(path)
db$url <- gsub(" ","+",paste0(
"https://www.ebay.com/sch/i.html?_from=R40&_trksid=p2334524.m570.l1313&_nkw=",
db$year,"+",
db$set,"+",
db$variation,"+",
db$name,"&_sacat=0&LH_TitleDesc=0&_osacat=0&_odkw=",
db$year,"+",
db$set,"+",
db$variation,"+",
db$name,"&LH_Complete=1&LH_Sold=1"
)
)
write.csv(db,path)
write.csv(db,path)
path <- "2023-Topps-Series-1-Baseball-Checklist.csv"
db <- fread(path)
db$url <- gsub(" ","+",paste0(
"https://www.ebay.com/sch/i.html?_from=R40&_trksid=p2334524.m570.l1313&_nkw=",
db$year,"+",
db$set,"+",
db$variation,"+",
db$name,"&_sacat=0&LH_TitleDesc=0&_osacat=0&_odkw=",
db$year,"+",
db$set,"+",
db$variation,"+",
db$name,"&LH_Complete=1&LH_Sold=1"
)
)
write.csv(db,path)
write.csv(db,path)
path <- "2023-Topps-Series-1-Baseball-Checklist.csv"
db <- fread(path)
db$url <- gsub(" ","+",paste0(
"https://www.ebay.com/sch/i.html?_from=R40&_trksid=p2334524.m570.l1313&_nkw=",
db$year,"+",
db$set,"+",
db$variation,"+",
db$name,"&_sacat=0&LH_TitleDesc=0&_osacat=0&_odkw=",
db$year,"+",
db$set,"+",
db$variation,"+",
db$name,"&LH_Complete=1&LH_Sold=1"
)
)
fwrite(db,path)
library(readr)
rm(db)
path <- "2023-Topps-Series-1-Baseball-Checklist.csv"
db <- fread(path)
db$url <- gsub(" ","+",paste0(
"https://www.ebay.com/sch/i.html?_from=R40&_trksid=p2334524.m570.l1313&_nkw=",
db$year,"+",
db$set,"+",
db$variation,"+",
db$name,"&_sacat=0&LH_TitleDesc=0&_osacat=0&_odkw=",
db$year,"+",
db$set,"+",
db$variation,"+",
db$name,"&LH_Complete=1&LH_Sold=1"
)
)
write_excel_csv(db,path)
get(wd)
getwd()
library(data.table)
library(tidyverse)
library(readxl)
library(openxlsx2)
doc <-  "2021-22-Panini-Illusions-Basketball-checklist-Excel-spreadsheet.xlsx" # .xlsx document name
sub_f <- "basketball" # subfolder where .xlsx file is stored
doc_path <- paste0(sport,doc) # combine to create the file path
doc <-  "2021-22-Panini-Illusions-Basketball-checklist-Excel-spreadsheet.xlsx" # .xlsx document name
sub_f <- "basketball" # subfolder where .xlsx file is stored
doc_path <- paste0(sub_f,doc) # combine to create the file path
db <- read_xlsx(doc_path)
doc_path <- paste0(sub_f,"/",doc) # combine to create the file path
db <- read_xlsx(doc_path)
View(db)
doc <-  "2021-22-Panini-Select-Basketball.xlsx" # .xlsx document name
sub_f <- "basketball" # subfolder where .xlsx file is stored
doc_path <- paste0(sub_f,"/",doc) # combine to create the file path
db <- read_xlsx(doc_path)
db_mod <- cbind(year = "2021-22",
company = "Panini",
set = "Select",
sport = "basketball",
db,
own = 0)
View(db_mod)
db_mod$url <- gsub(" ","+",paste0(
"https://www.ebay.com/sch/i.html?_from=R40&_nkw=",
db_mod$year,"+",
db_mod$company,"+",
db_mod$set,"+",
db_mod$variation,"+",
db_mod$name,
"&_sacat=0&LH_TitleDesc=0&LH_Complete=1&LH_Sold=1&rt=nc&LH_Auction=1"
)
)
write_xlsx(db_mod,doc_path)
doc <-  "2021-22-Panini-Select-Basketball.xlsx" # .xlsx document name
sub_f <- "basketball" # subfolder where .xlsx file is stored
doc_path <- paste0(sub_f,"/",doc) # combine to create the file path
db <- read_xlsx(doc_path)
# add additional data columns
db_mod <- cbind(year = "2021-22",
company = "Panini",
set = "Select",
sport = "basketball",
db,
own = 0)
# generate a link to completed eBay listings for each card
db_mod$url <- gsub(" ","+",paste0(
"https://www.ebay.com/sch/i.html?_from=R40&_nkw=",
db_mod$year,"+",
db_mod$company,"+",
db_mod$set,"+",
db_mod$variation,"+",
db_mod$name,
"&_sacat=0&LH_TitleDesc=0&LH_Complete=1&LH_Sold=1&rt=nc&LH_Auction=1"
)
)
# replace the .xlsx file with the newly modified version
write_xlsx(db_mod,doc_path)
doc <-  "2021-22-Panini-Select-Basketball.xlsx" # .xlsx document name
sub_f <- "basketball" # subfolder where .xlsx file is stored
doc_path <- paste0(sub_f,"/",doc) # combine to create the file path
db_mod <- read_xlsx(doc_path)
db_mod$url <- gsub(" ","+",paste0(
"https://www.ebay.com/sch/i.html?_from=R40&_nkw=",
db_mod$year,"+",
db_mod$company,"+",
db_mod$set,"+",
db_mod$variation,"+",
db_mod$name,
"&_sacat=0&LH_TitleDesc=0&LH_Complete=1&LH_Sold=1&rt=nc&LH_Auction=1"
)
)
# replace the .xlsx file with the newly modified version
write_xlsx(db_mod,doc_path)
doc <-  "2021-22-Panini-Select-Basketball.xlsx" # .xlsx document name
sub_f <- "basketball" # subfolder where .xlsx file is stored
doc_path <- paste0(sub_f,"/",doc) # combine to create the file path
db <- read_xlsx(doc_path)
# add additional data columns
db_mod <- cbind(year = "2021-22",
company = "Panini",
set = "Select",
sport = "basketball",
db,
own = 0)
# generate a link to completed eBay listings for each card
db_mod$url <- gsub(" ","+",paste0(
"https://www.ebay.com/sch/i.html?_from=R40&_nkw=",
db_mod$year,"+",
db_mod$company,"+",
db_mod$set,"+",
db_mod$variation,"+",
db_mod$name,
"&_sacat=0&LH_TitleDesc=0&LH_Complete=1&LH_Sold=1&rt=nc&LH_Auction=1"
)
)
# replace the .xlsx file with the newly modified version
write_xlsx(db_mod,doc_path)
doc <-  "2021-22-Panini-Select-Basketball.xlsx" # .xlsx document name
sub_f <- "basketball" # subfolder where .xlsx file is stored
doc_path <- paste0(sub_f,"/",doc) # combine to create the file path
db <- read_xlsx(doc_path)
# add additional data columns
db_mod <- cbind(year = "2021-22",
company = "Panini",
set = "Select",
sport = "basketball",
db,
own = 0)
# generate a link to completed eBay listings for each card
db_mod$url <- gsub(" ","+",paste0(
"https://www.ebay.com/sch/i.html?_from=R40&_nkw=",
db_mod$year,"+",
db_mod$company,"+",
db_mod$set,"+",
db_mod$variation,"+",
db_mod$name,
"&_sacat=0&LH_TitleDesc=0&LH_Complete=1&LH_Sold=1&rt=nc&LH_Auction=1"
)
)
# replace the .xlsx file with the newly modified version
write_xlsx(db_mod,doc_path)
